{"version":3,"file":"ionic-log-file-appender.umd.js","sources":["../../node_modules/tslib/tslib.es6.js","ng://ionic-log-file-appender/log.service.ts","ng://ionic-log-file-appender/log-file-appender.module.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {DatePipe} from '@angular/common';\r\nimport {Entry, File} from '@ionic-native/file';\r\nimport {Injectable} from '@angular/core';\r\nimport {Platform} from 'ionic-angular';\r\nimport * as _ from 'lodash'\r\nimport {ILogProviderConfig} from './config';\r\n\r\n/**\r\n * SmartMove Ionic rolling log file appender\r\n * CellTrack Systems Pty Ltd 2018\r\n */\r\n@Injectable()\r\nexport class LogProvider {\r\n\r\n    private fileLoggerReady = false;\r\n    private initFailed = false;\r\n    private currentFile: Entry;\r\n    private lines: 0;\r\n    private queue: string[] = [];\r\n    private processing = false;\r\n\r\n    private readonly defaultConfig: LogProviderConfig;\r\n\r\n    private config: LogProviderConfig;\r\n\r\n    constructor(private file: File,\r\n                private platform: Platform,\r\n                private datePipe: DatePipe) {\r\n        this.defaultConfig = new LogProviderConfig({\r\n            enableMetaLogging: false,\r\n            logToConsole: false,\r\n            logDateFormat: 'yyyy-MM-dd HH:mm:ss.SSS',\r\n            fileDateFormat: 'yyyy-MM-dd_HH-mm-ss-SSS',\r\n            fileMaxLines: 2000,\r\n            fileMaxSize: 1000000,\r\n            totalLogSize: 5000000,\r\n            baseDir: null,\r\n            logDir: 'logs',\r\n            logPrefix: 'log',\r\n            devMode: false\r\n        });\r\n        this.config = this.defaultConfig;\r\n    }\r\n\r\n    /**\r\n     * Initializes the file logger\r\n     */\r\n    init(configuration: ILogProviderConfig): Promise<any> {\r\n        return this.platform.ready()\r\n            .then(() => {\r\n                this.config = new LogProviderConfig(configuration);\r\n                // Any configuration not specified will take the defaults\r\n                this.config.merge(this.defaultConfig);\r\n                if (!this.config.baseDir) {\r\n                    // Can only initialise this after platform is ready\r\n                    this.config.baseDir = this.file.dataDirectory;\r\n                }\r\n                this.debug_metaLog('LogProvider initialised with configuration: ' + JSON.stringify(this.config));\r\n                this.fileLoggerReady = false;\r\n                this.debug_metaLog('Initialising file logger');\r\n                this.log('Initialising file logger');\r\n                if (!this.platform.is('cordova'))\r\n                {\r\n                    this.debug_metaLog('Not initialising file logger as the it is not supported by the platform ' + this.platform.url());\r\n                    this.initFailed = true;\r\n                    return Promise.resolve();\r\n                }\r\n                this.debug_metaLog('Data directory: ' + this.config.baseDir);\r\n                return this.file.checkDir(this.config.baseDir, this.config.logDir)\r\n                    .then(() => {\r\n                        this.debug_metaLog('Found logging directory');\r\n                        return this.initLogFile();\r\n                    })\r\n                    .catch(err => {\r\n                        this.debug_metaLog('Could not find logging directory: ' + JSON.stringify(err));\r\n                        return this.createLogDir();\r\n                    });\r\n        });\r\n    }\r\n\r\n    isReady(): boolean {\r\n      return this.fileLoggerReady;\r\n    }\r\n\r\n    /**\r\n     * Attempts to create the logging directory\r\n     */\r\n    private createLogDir(): Promise<any> {\r\n        this.debug_metaLog('Attempting to create logging directory');\r\n        return this.file.createDir(this.config.baseDir, this.config.logDir, false)\r\n            .then(() => {\r\n                this.debug_metaLog('Successfully created logging directory');\r\n                return this.initLogFile();\r\n            })\r\n            .catch(err => {\r\n                this.initFailed = true;\r\n                this.debug_metaLog('Failed to create logging directory: ' + JSON.stringify(err));\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Attempts to initialise the current log file\r\n     * @returns a promise upon completion or failure\r\n     */\r\n    private initLogFile(): Promise<any> {\r\n        this.debug_metaLog('Attempting to initialise log file');\r\n        return this.file.listDir(this.config.baseDir, this.config.logDir)\r\n            .then((entries: Entry[]) => {\r\n                if (entries && entries.length > 0) {\r\n                    this.debug_metaLog(entries.length + ' existing log files found.');\r\n                    return this.cleanupFiles(entries);\r\n                } else {\r\n                    this.debug_metaLog('No existing log files found.');\r\n                    return this.cleanupCompleted(null, 0, null);\r\n                }\r\n            })\r\n            .catch(err => {\r\n                this.debug_metaLog('Failed to get file list: ' + JSON.stringify(err, Object.getOwnPropertyNames(err)));\r\n                throw err;\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Checks the total size of log files against the configured maximum size and deletes oldest if necessary\r\n     * @param entries the files found in the logging directory\r\n     */\r\n    private async cleanupFiles(entries: Entry[]): Promise<any> {\r\n        this.debug_metaLog('Starting cleanup of ' + entries.length + ' log files');\r\n        entries = _.filter(entries, (entry: Entry) => entry.isFile && entry.name && entry.name.startsWith(this.config.logPrefix));\r\n        if (entries.length === 0) {\r\n            return this.cleanupCompleted(null, 0, null)\r\n                .catch(err => {\r\n                  // Now we're well and truly buggered\r\n                  this.initFailed = true;\r\n                  throw err;\r\n                });\r\n        }\r\n        entries = _.orderBy(entries, ['name'],['asc']);\r\n        let total = entries.length;\r\n        let calculated = 0;\r\n        let sizeTotal = 0;\r\n        try {\r\n            // Loop over entries\r\n            for (let entry of entries) {\r\n                const size = await this.getFileSize(entry);\r\n                // Calculate total size of log files\r\n                calculated++;\r\n                sizeTotal += size;\r\n                this.debug_metaLog('After ' + calculated + ' files, total size is ' + sizeTotal);\r\n                if (sizeTotal > this.config.totalLogSize) {\r\n                    this.debug_metaLog('Total log file size exceeds limit: ' + sizeTotal);\r\n                    return this.maxSizeExceeded(entries, size)\r\n                        .catch(err => {\r\n                          // Now we're well and truly buggered\r\n                          this.initFailed = true;\r\n                          throw err;\r\n                        });\r\n                } else if (calculated === total) {\r\n                    this.debug_metaLog('Total log file size is ok: ' + sizeTotal);\r\n                    // Below max size, so we're ready to go\r\n                    const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n                    return this.cleanupCompleted(lastEntry, size, null)\r\n                        .catch(err => {\r\n                          // Now we're well and truly buggered\r\n                          this.initFailed = true;\r\n                          throw err;\r\n                        });\r\n                }\r\n            }\r\n        } catch(failure) {\r\n            const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n            // Not much we can do except try to continue\r\n            return this.cleanupCompleted(lastEntry, 0, failure)\r\n                .catch(err => {\r\n                    // Now we're in real trouble\r\n                    this.initFailed = true;\r\n                    throw err;\r\n                });\r\n        }\r\n    }\r\n\r\n  /**\r\n   * Wraps getMetadata in a Promise\r\n   * @param entry\r\n   * @returns a promise\r\n   */\r\n    private async getFileSize(entry: Entry): Promise<number> {\r\n      return new Promise((resolve: ((number) => void), reject) => {\r\n      entry.getMetadata(metadata => {\r\n          resolve(metadata.size);\r\n        }, failure => {\r\n          reject('SEVERE ERROR: could not retrieve metadata. ' + JSON.stringify(failure));\r\n        })\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Attempts to remove one file and recursively check total size again\r\n     * @param entries\r\n     * @param lastEntrySize\r\n     * @param resolve\r\n     * @param reject\r\n     */\r\n    private maxSizeExceeded(entries: Entry[], lastEntrySize: number): Promise<any> {\r\n        return this.removeFile(entries[0])\r\n            .then(() => {\r\n                this.debug_metaLog('Entry successfully removed');\r\n                // Remove oldest entry\r\n                entries.shift();\r\n                // Check again\r\n                return this.cleanupFiles(entries);\r\n            })\r\n            .catch(err => {\r\n                const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n                // Not much we can do except try to continue\r\n                return this.cleanupCompleted(lastEntry, lastEntrySize, 'SEVERE ERROR: could not clean up old files. ' + err);\r\n            })\r\n    }\r\n\r\n    /**\r\n     * When file cleanup is completed, attempts to initialise config to point to current log file\r\n     * @param lastEntry The most recent existing log file\r\n     * @param lastEntrySize The size of the most recent existing log file\r\n     * @param error Any error to be logged after initialization\r\n     */\r\n    private cleanupCompleted(lastEntry: Entry, lastEntrySize: number, error: string): Promise<any> {\r\n        this.debug_metaLog('Log file cleanup done');\r\n        if (lastEntry && lastEntrySize < this.config.fileMaxSize) {\r\n            this.currentFile = lastEntry;\r\n            this.fileLoggerReady = true;\r\n            if (error) {\r\n                this.log(error);\r\n            }\r\n            this.debug_metaLog('File logger initialised at existing file: ' + this.currentFile.fullPath);\r\n            this.log('File logger initialised at existing file: ' + this.currentFile.name);\r\n            return Promise.resolve();\r\n        } else {\r\n            this.debug_metaLog('Last file nonexistent or too large. Creating new log file');\r\n            return this.createNextFile()\r\n                .then(() => {\r\n                    this.fileLoggerReady = true;\r\n                    if (error) {\r\n                        this.log(error);\r\n                    }\r\n                    this.debug_metaLog('File logger initialised at new file: ' + this.currentFile.fullPath);\r\n                    this.log('File logger initialised at new file: ' + this.currentFile.name);\r\n                    return Promise.resolve();\r\n                });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Attempts to remove a file\r\n     * @param entry\r\n     */\r\n    private removeFile(entry: Entry): Promise<any> {\r\n        this.debug_metaLog('Removing file: ' + entry.fullPath);\r\n        const fullPath = entry.fullPath;\r\n        const path = fullPath.replace(entry.name, '');\r\n        return this.file.removeFile(this.config.baseDir + path, entry.name);\r\n    }\r\n\r\n    /**\r\n     * Puts the message on the queue for writing to file\r\n     * @param message\r\n     * @param err. If true, logging is at error level\r\n     */\r\n    private logInternal(message: string, err?: boolean): void {\r\n        const date = new Date();\r\n        const dateString = this.datePipe.transform(date, this.config.logDateFormat);\r\n        const logMessage = '[' + dateString + '] ' + message + '\\r\\n';\r\n        if (this.config.logToConsole) {\r\n            if (err) {\r\n              console.error(logMessage);\r\n            } else {\r\n              console.log(logMessage);\r\n            }\r\n        }\r\n        if (this.initFailed) {\r\n            this.debug_metaLog('File logger init has failed! Message discarded');\r\n            return;\r\n        } else {\r\n            // Put the message on the queue\r\n            this.queue.push(logMessage);\r\n            if (this.fileLoggerReady) {\r\n                if (this.queue.length > 0 && !this.processing) {\r\n                    this.processing = true;\r\n                    this.doProcess();\r\n                }\r\n            } else {\r\n                this.debug_metaLog('File logger is not ready! Message left on queue');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Logs a message at info level\r\n     * @param message\r\n     */\r\n    log(message: string): void {\r\n      this.logInternal(message, false);\r\n    }\r\n\r\n    /**\r\n     * Developer-level logging\r\n     * @param message\r\n     */\r\n    logDev(message: string): void {\r\n        if (this.config.devMode) {\r\n            this.log('*DEBUG* ' + message);\r\n        }\r\n    }\r\n\r\n  /**\r\n   * Error-level logging with optional error object\r\n   * @param message\r\n   * @param error\r\n   */\r\n    err(message: string, error?: any): void {\r\n        let logMessage = 'ERROR! ' + message;\r\n        if (error) {\r\n            logMessage += ': ' + JSON.stringify(error, Object.getOwnPropertyNames(error));\r\n        }\r\n        this.logInternal(logMessage, true);\r\n    }\r\n\r\n    /**\r\n     * Writes the current logging queue to file\r\n     */\r\n    private doProcess(): void {\r\n        this.debug_metaLog('Beginning processing loop');\r\n        this.processQueue()\r\n            .then(() => {\r\n                if (this.queue.length > 0) {\r\n                    this.doProcess();\r\n                } else {\r\n                    this.checkFileLength()\r\n                        .then(() => {\r\n                            this.processing = false;\r\n                        })\r\n                        .catch(err => {\r\n                            this.debug_metaLog('Error checking file length: ' + JSON.stringify(err));\r\n                            this.processing = false;\r\n                        });\r\n                }\r\n            })\r\n          .catch(err => {\r\n                this.debug_metaLog('Error processing queue: ' + err);\r\n                this.processing = false;\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Writes the oldest entry in the queue to file, then checks if file rollover is required\r\n     */\r\n    private processQueue(): Promise<any> {\r\n        this.debug_metaLog('Processing queue of length ' + this.queue.length);\r\n        if (this.queue.length > 0) {\r\n            const message = this.queue.shift();\r\n            return this.file.writeFile(this.config.baseDir + '/' + this.config.logDir, this.currentFile.name, message, {\r\n                append: true,\r\n                replace: false\r\n            })\r\n                .then(() => {\r\n                    this.lines++;\r\n                    return this.checkFileLength();\r\n                })\r\n                .catch(err => {\r\n                    this.debug_metaLog('Error writing to file: ' + err);\r\n                });\r\n        } else {\r\n          return Promise.resolve();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks the file length and creates a new file if required\r\n     */\r\n    private checkFileLength(): Promise<any> {\r\n        if (this.lines >= this.config.fileMaxLines) {\r\n            this.debug_metaLog('Creating new file as max number of log entries exceeded');\r\n            return this.createNextFile();\r\n        } else {\r\n            return Promise.resolve();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Generates a log file name from the current time\r\n     */\r\n    private createLogFileName(): string {\r\n        const date = new Date();\r\n        const dateString =this.datePipe.transform(date, this.config.fileDateFormat);\r\n        return this.config.logPrefix + '.' + dateString + '.log'\r\n    }\r\n\r\n    /**\r\n     * Creates the next log file and updates the local reference\r\n     */\r\n    private createNextFile(): Promise<any> {\r\n        const fileName = this.createLogFileName();\r\n        this.debug_metaLog('Attempting to create file at: ' + this.config.baseDir + this.config.logDir + '/' + fileName);\r\n        return this.file.createFile(this.config.baseDir + '/' + this.config.logDir, fileName, true)\r\n            .then(newFile => {\r\n                this.lines = 0;\r\n                this.currentFile = newFile;\r\n                this.debug_metaLog('Created new file: ' + this.currentFile.fullPath);\r\n            })\r\n            .catch(err => {\r\n                this.debug_metaLog('Failed to create new file: ' + JSON.stringify(err));\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Retrieves the current list of log files in the logging directory\r\n     */\r\n    getLogFiles(): Promise<Entry[]> {\r\n        this.debug_metaLog('Attempting to retrieve log files');\r\n        if (this.initFailed) {\r\n            this.debug_metaLog('Log never initialised so can\\'t retrieve files');\r\n            return Promise.resolve([]);\r\n        } else {\r\n            return this.file.listDir(this.config.baseDir, this.config.logDir);\r\n        }\r\n    }\r\n\r\n    private debug_metaLog(message: string): void {\r\n        if (this.config.enableMetaLogging) {\r\n            console.log('**LOGGER_META**: ' + message);\r\n        }\r\n    }\r\n}\r\n\r\nclass LogProviderConfig implements ILogProviderConfig {\r\n    // If true, logs verbose details of file logging operations to console\r\n    enableMetaLogging: boolean;\r\n\r\n    // If true, all file log messages also appear in the console\r\n    logToConsole: boolean;\r\n\r\n    // Date format used in log statements\r\n    logDateFormat: string;\r\n\r\n    // Date format used in log file names.\r\n    // NOTE: be careful with special characters like ':' as this can cause file system issues\r\n    fileDateFormat: string;\r\n\r\n    // Maximum number of log statements before file rollover\r\n    fileMaxLines: number;\r\n\r\n    // If the last log file exceeds this size on initialization, a new log file will be created\r\n    fileMaxSize: number;\r\n\r\n    // If the total size of all log files exceeds this size on initialisation, oldest files will be removed\r\n    totalLogSize: number;\r\n\r\n    // Name of directory to create for logs, within the baseDir\r\n    logDir: string;\r\n\r\n    // Name of directory in which to create log directory\r\n    baseDir: string;\r\n\r\n    // Prefix for log files\r\n    logPrefix: string;\r\n\r\n    // Developer-level logging will appear in log files if true\r\n    devMode: boolean;\r\n\r\n    constructor(fields: any) {\r\n        // Quick and dirty extend/assign fields to this model\r\n        for (const f in fields) {\r\n            // @ts-ignore\r\n            this[f] = fields[f];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Overrides this object's uninitialized fields with the passed parameter's fields\r\n     * @param config\r\n     */\r\n    merge(config: any) {\r\n      for (let k in config) {\r\n        if (!(k in this)) {\r\n          this[k] = config[k];\r\n        }\r\n      }\r\n    }\r\n}\r\n","import {CommonModule} from '@angular/common';\r\nimport {ModuleWithProviders, NgModule} from '@angular/core';\r\nimport {LogProvider} from './log.service';\r\n\r\nexport * from './log.service';\r\nexport * from './config';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  providers: [LogProvider]\r\n})\r\nexport class LogFileAppenderModule {\r\n  public static forRoot(): ModuleWithProviders {\r\n     return {\r\n       ngModule: LogFileAppenderModule,\r\n       providers: [LogProvider]\r\n     };\r\n  }\r\n\r\n  public static forChild(): ModuleWithProviders {\r\n    return {\r\n      ngModule: LogFileAppenderModule,\r\n      providers: [LogProvider]\r\n    }\r\n  }\r\n}\r\n"],"names":["_.filter","_.orderBy","tslib_1.__values","Injectable","File","Platform","DatePipe","NgModule","CommonModule"],"mappings":"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"}